# SVG 튜토리얼 정리

# 예시

[https://codepen.io/lee0jae330/pen/MYeyQep](https://codepen.io/lee0jae330/pen/MYeyQep)

```html
<svg version="1.1"
     baseProfile="full"
     width="300" height="200"
     xmlns="http://www.w3.org/2000/svg">

  <rect width="100%" height="100%" fill="red" />

  <circle cx="150" cy="100" r="80" fill="green" />

  <text x="150" y="125" font-size="60" text-anchor="middle" fill="white">SVG</text>

</svg>
```

위 코드를 example.svg로 저장하고 브라우저에서 실행하면 위 codepen 화면이 그려진다.

화면이 그려지는 과정은 다음과 같다.

1. SVG 루트 요소부터 시작함
    - DTD 기반의 SVG 유효성 검사는 해결할 수 있는 것보다 많은 문제를 발생시키기에 (X)HTML로 알려진 Doctype 선언은 사용하지 않음
        
        (SVG에서 DOCTYPE을 통해 XHTML이라고 선언하면 브라우저가 문서를 해석할 때 오류가 나거나 느려지는 경우가 많았음)
        
    - 다른 유형의 유형성 검사를 위해 SVG 버전을 식별하려면 항상 version과 baseProfile 속성(Attribute)을 사용해야 함
    - XML 특수언어로서 SVG는 항상 네임스페이스를 올바르게 바인딩해야 한다.
        
        <aside>
        💡
        
        XML 특수언어 ⇒ SVG는 HTML의 사촌 격인 XML이라는 언어의 한 종류이다.
        
        네임스페이스 바인딩 ⇒ rect, line 같은 태그들은 일반 HTML이 아니라 SVG 전용이다. 라고 선언하는 주소를 적어주는 것임
        
        `<svg xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)">`
        
        </aside>
        
2. 전체 이미지 영역을 포함하는 사각형 <rect/>을 그려 배경을 빨간색으로 설정
3. 빨간색 직사각형의 중앙에 반경 80px의 녹색 원 <circle/>이 그려짐
4. 텍스트 “SVG”가 그려짐. 각 문자의 내부는 흰색으로 채워짐. 텍스트는 중심점이 되고자 하는 지점에 앵커를 설정하여 배치함.
    
    이 경우, 중심점은 녹색 원의 중심에 일치해야 함
    

# SVG 파일 형식

SVG 파일은 두 가지 형태로 제공됨

일반 SVG 파일은 SVG 마크업이 포함된 간단한 텍스트 파일

이러한 파일의 권장 파일 확장자는 `.svg` 이다.

일부 응용 프로그램에서는 매우 큰 크기의 SVG 파일이 있을 수 있기 때문에 SVG 사양에서는 gzipo으로 압축된 SVG 파일을 허용함. 이때 파일 확장자는 `.svgz` 이다.

# SVG에서 위치 개념

<img width="220" height="220" alt="image" src="https://github.com/user-attachments/assets/30144b18-687e-4ed0-925a-8cb462d6ff3e" />

모든 요소에 대해 SVG는 캔버스를 포함한 컴퓨터에서 무언가를 그리고자 할 때 많이 사용되는 것과 유사한 좌표계 혹은 그리드 시스템을 사용한다.

문서의 왼쪽 위 모서리는 (0,0)으로 간주되며 한 지점의 위치는 왼쪽 상단 모서리에서 픽셀 단위로 표시되고 X축의 양의 방향은 오른쪽으로, Y축 양의 방향은 아래쪽으로 향하게 됨

HTML의 요소가 배치되는 것과 같은 방법이다.

```html
<rect x="0" y="0" width="100" height="100" />
```

위 요소는 왼쪽 상단에서 100 * 100 px의 정사각형을 의미함

## 픽셀이란 ?

기본적으로 SVG 문서에서 1픽셀은 출력 장치(화면)의 1픽셀에 매핑된다. 하지만 이러한 방식만 가능했다면 SVG의 이름에 “확장성”이라는 단어가 들어가 있지 않을 것이다.

CSS의 절대 및 상대 글꼴 크기px, rem, em)와 매우 흡사하게 SVG는 절대적인 단위를 정의하고 이것을 사용자 단위 명칭하며, 이것은 별도의 식별자 없이 숫자 그대로를 사용한다.

사용자 단위와 화면 단위는 1:1 비율로 동작함

```html
<svg width="100" height="100">
```

위 요소는 100 * 100px의 SVG 캔버스를 정의한다. 이때 사용자 단위와 화면 단위는 1:1의 비율로 동작한다.

```html
<svg width="200" height="200" viewBox="0 0 100 100">
```

SVG 캔버스의 전체 크기는 200*200 픽셀이다. 그러나 viewBox 속성을 사용하여 (0,0)에서 시작하는 100*100px의 화면을 200*200px의 화면에 출력한다.

이렇게 하면 100*100 단위 영역을 효과적으로 확대하고 이미지를 2배 크기로 확대 할 수 있다.

### 예시

```html
<svg width="200" height="200" viewBox="0 0 100 100">
  <circle cx="50" cy="50" r="10" />
</svg>
```

원(circle)은 viewBox 기준 가로 세로 절반인 지점 (50,50)에 위치한다.

하지만 SVG가 보여지는 화면에서 width, height가 모두 200이기 때문에, 화면에서는 화면 중앙인 100픽셀 지점에 원이 그려진다.

반지름 10으로 그렸지만, 화면이 2배 커졌으므로 실제 우리 눈에는 반지름 20픽셀짜리 원으로 보이게 된다.

# 기본 도형

## 사각형

`<rect/>` ⇒ 사각형을 화면에 그림

```html
<rect x="10" y="10" width="30" height="30"/>
<rect x="60" y="10" rx="10" ry="10" width="30" height="30"/>
```

### 속성

x: 사각형 좌측 상단의 x값

y: 사각형 좌측 상단의 y값

width, height: 사각형의 너비, 높이

rx: 사각형의 둥근 꼭짓점의 x방향으로의 반지름

ry: 사각형의 둥근 꼭짓점의 y방향으로의 반지름

## 원

`<circle/>` ⇒ 원을 화면에 그림

```html
<circle cx="25" cy="75" r="20" />
```

### 속성

r: 원의 반지름

cx, cy: 원의 중심의 x, y값

## 타원

`<ellipse />` ⇒ 타원을 그린다.

```html
<ellipse cx="75" cy="75" rx="20" ry="5" />
```

rx: 타원의 x방향으로 반지름의 길이를 의미

ry: 타원의 y방향으로 반지름의 길이를 의미

cx, cy: 타원의 중심 x, y값

## 선

`<line/>` ⇒ 직선을 그린다.

```html
<line x1="10" x2="50" y1="110" y2="150" />
```

x1, y1: 점1의 x, y 값

x2, y2: 점2의 x,y값

## Polyline

`<polyline/>` ⇒ 연결된 직선들의 그룹

```html
<polyline
  points="60 110, 65 120, 70 115, 75 130, 80 125, 85 140, 90 135, 95 150, 100 145" />
```

points: 점들의 목록, 각 숫자는 공백, 쉼표 또는 줄 바꿈 문자로 구분됨

<aside>
💡

반드시 x좌표와 y좌표를 가지고 있어야 한다.

(0,0), (1,1), (2,2) ⇒ “0 0, 1 1, 2 2”라고 쓸 수 있음

</aside>

## 다각형

`<polygon/>` ⇒ 다각형을 그린다.

polyline과 매우 유사하다. 하지만, 마지막 점과 첫 번째 점을 연결하여 닫힌 모양을 만든다.

```html
<polygon
  points="50 160, 55 180, 70 180, 60 190, 65 205, 50 195, 35 205, 40 190, 30 180, 45 180" />
```

points: polyline과 동일하다.

## Path

패스는 SVG에서 사용할 수 있는 가장 일반적인 형태이다.

`<path/>` 요소를 사용해서 사각형, 원, 타원, 폴리라인 및 다각형을 그릴 수 있다.

다른 모든 종류의 모양, 베지어 곡선, 2차원 곡선 등이 가능하다.

```html
<path d="M 20 230 Q 40 205, 50 230 T 90230" />
```

# Path

`<path/>` 는 SVG 기본 도형 라이브러리에서 가장 강력한 요소이다.

선과 곡선, 호 등 다양한 형태를 그릴 수 있다.

path는 여러 개의 직선과 곡선을 합쳐서 복잡한 도형을 그릴 수 있게 해준다. 직선으로만 이루어진 복잡한 도형은 `polyline`으로도 그릴 수 있지만, 곡선을 묘사할 때 polyline은 path로 그린 도형에 비해 더 많은 직선이 필요해 확대가 잘되지 않을 수 있다.

path의 모양은 `d` 속성 하나로 정의된다.

`“d”` 속성은 여러 개의 명령어의 그 파라미터들로 이루어진다.

## Line 명령어

`<path>` 노드에는 다섯 개의 선 명령어가 있다. 이름에서 알 수 있듯이 각각의 명령어는 두 점 사이에 선을 그리는 역할을 한다.

### M

첫 번째 명령어는 “Move To(이동하기)” 혹은 “M” 이다.

이 명령어는 두 개의 파라미터로 x와 y좌푤를 받는다.

그리기 커서가 이미 페이지의 다른 곳에 있었더라도 두 점 사이에 점이 그려지지 않는다.

```html
M x y
```

혹은

```html
m dx dy (소문자인 경우, 현재 위치 기준으로 x방향으로 dx만큼, y방향으로 dy만큼 이동한다)
```

```html
<svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">

  <path d="M10 10"/>

  <!-- 점 -->
  <circle cx="10" cy="10" r="2" fill="red"/>

</svg>
```

좌표 (10,10)에만 점을 찍었다. 일반적으로 path를 그릴 때는 이 점이 나타나지 않는다는 점에 주의해야 한다.

### L

선을 그리는 명령어는 3가지가 있다.

가장 일반적인 것은 ‘L’이라 부르는 “Line To(선 그리기)” 명령어이다. L 명령어 x, y라는 두 개의 인자를 받아서 

현재 위치에서 새 위치로 선을 긋는다.

```html
L x y (혹은 l dx ly)
(소문자인 경우, 현재 위치 기준으로 x방향으로 dx만큼, y방향으로 dy만큼 이동한 뒤 직선을 그린다.)
```

### H, V

가로선과 세로선을 그리는 축약 명령어도 있다. ‘H’는 가로선을 그리고, ‘V’는 세로선을 그릴 수 있다.

```html
H x (혹은 h dx)
V x (혹은 v dy)
```

```html
<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">

  <path d="M10 10 H 90 V 90 H 10 L 10 10"/>

  <!-- 점 -->
  <circle cx="10" cy="10" r="2" fill="red"/>
  <circle cx="90" cy="90" r="2" fill="red"/>
  <circle cx="90" cy="10" r="2" fill="red"/>
  <circle cx="10" cy="90" r="2" fill="red"/>

</svg>
```

1. 좌표 (10,10)에서 가로선을 x=90까지 그린다.
2. (90, 10)에서 세로선을 y=90까지 그린다.
3. (90, 90)에서 가로선을 x=10까지 그린다.
4. (90, 10)에서 (10, 10)로 직선을 그린다.

<img width="212" height="139" alt="image 1" src="https://github.com/user-attachments/assets/6d5bf518-aeb6-4cd3-bab2-cca6584ae71a" />

(물론 `<rect/>`을 통해 쉽게 그릴 수도 있다.)

### Z

`Z` 라는 Close Path (path 닫기) 명령어를 통해 쉽게 패스를 닫을 수 있다.

이 명령어는 현 위치에서 시작점으로 직선을 그린다. 보통 path의 끝에 자주 쓰인다.

Z (혹은 z) (Z는 대소문자 동작 차이가 없다.)

위 사각형 요소를 짧게 줄이면 아래처럼 된다.

```html
<path d="M10 10 H 90 V 90 H 10 Z" fill="transparent" stroke="black"/>
```

위 형태를 소문자 명령어 즉, 상대좌표로도 표현할 수 있다.

```html
<path d="M10 10 h 80 v 80 h -80 Z" fill="transparent" stroke="black"/>
```

## 곡선 (Curve) 명령어

부드러운 곡선을 그릴 수 있는 3가지 명령어가 있다.

이 중 2가지는 베지어 곡선(bezier curve)이며, 나머지 하나는 원의 조각인 ‘호’(arc)이다.

베지어 곡선의 종류는 무한하지만, path 요소에서는 가장 간단한 두 종류만 지원한다.

하나는 ‘C’라고 부르는 3차 (Cubic) 베지어 곡선이고, 다른 하나는 ‘Q’로 사용되는 2차 (Quadratic) 베지어 곡선이다.2차 베지어 곡선은 점 3개가 필요하다

<aside>
💡

$P_0$(시작점), $P_1$(조절점), $P_2$(끝점)

1. 선분 P_0P_1을 t : (1-t)로 내분하는 점Q_0를 잡는다.
2. 선분 P_1P_2를 똑같은 t : (1-t)로 내분하는 점Q_1를 잡는다.
3. 다시 선분 Q_0Q_1을 t : (1-t)로 내분하는 점 B(t)를 잡는다.
4. 점 B(t)가 0에서 1까지 변할 때 B(t)가 그리는 곡선이 바로 Quadratic 베지어 곡선이다.
    
    ![](https://github.com/codingapple1/bezier/raw/main/sample.webp)
    
    - 직접 해보기
        
        [https://codepen.io/lee0jae330/pen/wvZPNBN](https://codepen.io/lee0jae330/pen/wvZPNBN)
        
        [https://codingapple1.github.io/bezier/cubic.html](https://codingapple1.github.io/bezier/cubic.html)
        

3차 베지어 곡선은 점 4개가 필요하다.

$P_0$(시작점), $P_1$(조절점), $P_2$(조절점),  $P_3$(끝점)이 있을 때
• **1단계 (선분 3개):**
    ◦ $P_0-P_1$ 사이의 내분점 $A$
    ◦ $P_1-P_2$ 사이의 내분점 $B$
    ◦ $P_2-P_3$ 사이의 내분점 $C$
• **2단계 (선분 2개):**
    ◦ $A-B$ 사이의 내분점 $D$
    ◦ $B-C$ 사이의 내분점 $E$
• **3단계 (최종 점):**
    ◦ $D-E$ 사이의 내분점 **$B(t)$**

이때 B(t)가 t = 0 ~ 1에 따라 그리는 궤적이 바로 Cubic 베지어 곡선이다.

<img width="807" height="436" alt="image 2" src="https://github.com/user-attachments/assets/6c0666ff-2130-4432-9641-4e85fcc23c58" />

</aside>

### C

3차 베지어 곡선인 ‘C’는 조금 복잡한 곡선이다. 3차 베지어 곡선은 선을 잇는 두 점에 하나씩 제어씩을 가지고 있다. 그러므로 3차 베지어 곡선을 그리려면 총 3개의 좌표가 필요하다.

```html
 C x1 y1, x2 y2, x y (혹은 c dx1 dy1, dx2 dy2, dx dy)
```

마지막으로 지정된 좌표 (x,y)는 곡선의 끝점이다. 나머지 2개는 제어점이며, 첫 번째 제어점은 (x1,y1), 두 번째 제어점은 (x2, y2)이다.

### S

여러 베지어 곡선을 연결하여 확장된 곡선 형태를 만들 수도 있다. 한 선의 제어점을 다른 선의 제어점과 반대 방향으로 그어서 완만한 경사를 만들어야 할 때가 많은데, 이 경우에는 간단한 형태의 3차 베지어 곡선 명령어인 `S` 를 활용할 수 있다.

```html
 S x2 y2, x y (혹은 s dx2 dy2, dx dy)
```

x,y는 끝점의 x,y값, x2,y2는 두 번째 제어점의 x,y값이다.

`S`는 `S`나 `C` 명령어 다음에 올 경우 첫 번째 제어점은 이전에 사용했던 두 번째 제어점을 현재 점에 대해 대칭 이동시킨 위치를 자신의 ‘첫 번재 제어점’으로 자동 사용한다.

`S`명령어가 다른 `S`나 `C` 명령어 다음에 오지 않을 경우, 현재 커서 위치가 첫 번째 제어점으로 사용되며, 이 경우에 그려지는 결과는 `Q` 명령어로 같은 인자를 사용해서 그린 결과와 같게 된다.

```html
<svg width="190" height="160" xmlns="http://www.w3.org/2000/svg">
  <path d="M10 80 C 40 10, 65 10, 95 80 S 150 150, 180 80" stroke="black" fill="transparent"/>
</svg>
```
<img width="242" height="145" alt="image 3" src="https://github.com/user-attachments/assets/16e3ee7c-2fa3-43ac-9783-911f0dfd29ea" />

위 예제는 다음과 같다.

1. 시작점 (10, 80)
2. 시작점 (10, 80), 첫 번째 제어점 (40,10), 두 번째 제어점 (65, 10), 끝점(95, 80)을 갖는 3차 베지어 곡선을 그린다.
3. S 150 150, 180 80을 통해 두 번째 곡선을 그린다.
    - 시작점: 점(95, 80)
    - 첫 번째 제어점: 점(65,10)을 점 (95,80)을 기준으로 점 대칭한 점
    - 두 번째 제어점: 점(150,150)
    - 끝점: 점(180, 80)

### Q

3차 베지어 곡선보다 간단한 다른 형태의 곡선은 `Q` 라고 부르는 2차 베지어 곡선이며, 하나의 제어점이 시작점과 끝점의 방향을 모두 결정한다.

```html
 Q x1 y1, x y (혹은 q dx1 dy1, dx dy)
```

x,y ⇒ 끝점의 좌표

x1, y1 ⇒ 제어점의 좌표

3차 베지어 곡선과 같이 2차 베지어 곡선을 연결하는 단축 명령어가 있으며, T라고 부름

```html
 T x y (혹은 t dx dy)
```

이 축약 명령어는 이전에 사용한 제어점으로부터 새로운 제어점을 만들어낸다. 즉, 처음에 제어점을 하나만 기술하면 끝점만을 계속 이어서 꽤 복잡한 도형을 만들 수 있다고 한다.

`C`, `Q` 두 종류의 곡선이 비슷한 결과를 만들어내긴 하지만, 3차 곡선의 경우 모양을 더 자유롭게 수정할 수 있다. 둘 중 어느 것이 좋은지는 그때그때 고려해서 사용하면 된다.

### 원호(Arc)

SVG로 그릴 수 있는 다른 형태의 곡선으로는 A라고 부르는 호가 있다. 호는 원이나 타원의 일부분을 말한다. 

시작점, 끝점, 반지름이 주어졌을 때(두 점이 충분히 가깝다고 가정할 때) 두 점을 연결할 수 있는 타원은 2개가 있으며, 각각의 타원에서 두 점을 잇는 경로 또한 2개씩 있기 때문에 어떤 상황에서든 4종류의 호를 그릴 수 있다.

<img width="761" height="763" alt="image 4" src="https://github.com/user-attachments/assets/dd321f40-1493-4fb8-8335-ff7c6c6d4591" />

위 그림을 보면, 왜 4종류의 호를 그릴 수 있는지 알 수 있다.

이로 인해 Arc 명령어는 7개의 인자를 받는다.

```html
 A rx ry x-axis-rotation large-arc-flag sweep-flag x y
 a rx ry x-axis-rotation large-arc-flag sweep-flag dx dy
```

- rx, ry
    - 반지름을 의미한다.
    - rx = 타원의 가로 반지름
    - ry = 타원의 세로 반지름
- x-axis-rotation
    - x축 회전각을 의미한다.
    - 타원 자체가 기울어진 각도이다.
- large-arc-flag
    - 큰 호 플래그를 의미한다.
    - 0이면 작은 호(180도 미만), 1이면 큰 호 (180도 이상)을 그린다.
- sweep-flag
    - 쓸기 방향 플래그이다.
    - 0이면 반시계 방향, 1이면 시계 방향으로 그린다.
- x, y
    - 끝 점 좌표를 의미한다.
    - 호가 끝나는 지점의 절대 좌표 (dx, dy이면 상대 좌표이다.)

```html
<svg width="320" height="320" xmlns="http://www.w3.org/2000/svg">
  <path d="M10 315
           L 110 215
           A 30 50 0 0 1 162.55 162.45
           L 172.55 152.45
           A 30 50 -45 0 1 215.1 109.9
           L 315 10" stroke="black" fill="green" stroke-width="2" fill-opacity="0.5"/>
</svg>
```
<img width="376" height="331" alt="image 5" src="https://github.com/user-attachments/assets/bd584f81-10ce-4a62-8ade-f03730b2c27e" />

x축 회전각이 0인 호는 똑바로 서 있다.

두 번째 호는 x축 회전각이 -45도이므로 타원이 회전을 한 것을 알 수 있다.

큰 호 플래그가 0이면 다음과 같다.

<img width="623" height="591" alt="image 6" src="https://github.com/user-attachments/assets/51d5d33c-3719-4f3f-80f5-7a40b093f33b" />

큰 호 플래그가 1이면 다음과 같다.

<img width="610" height="581" alt="image 7" src="https://github.com/user-attachments/assets/1d7df55e-9ac8-4927-979c-d53695e76ac6" />

녹색으로 칠한 부분이 호의 후보가 된다.

쓸기 플래그가 0이면 반시계방향으로 호를 그리고, 1이면 시계 방향으로 호를 그리게 된다.

마지막 두 개의 매개변수는 호가 끝나는 x와 y 좌표를 지정한다. 호는 도면에서 원 또는 타원 조각을 쉽게 만들 수 있는 방법이다. 예를 들어 원그래프는 각 조각마다 다른 호가 필요하다.

원을 한바퀴 도는 path의 경우, 시작과 끝점이 같으므로 선택할 수 있는 원이 무한히 있으므로, 실제 path를 정의할 수 없다. 이때는 시작점과 끝점을 살짝 비뚤어지게 배치하고 이 둘을 다른 path 선으로 이음으로써 비슷하게 할 수는 있다. 이때는 circle, ellipse를 쓰는 것이 쉬울 때가 많다.

# 참고

https://developer.mozilla.org/ko/docs/Web/SVG/Tutorials/SVG_from_scratch